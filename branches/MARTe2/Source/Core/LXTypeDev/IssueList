1) Fix the round up which add a number in surplus.
2) Try to avoid precision errors of the divisions in macros CHECK_AND_...
